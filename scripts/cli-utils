# usage: $ source scripts/cli-utils
# shellcheck shell=bash

# regression tests diff
# to focus on a particular test, do e.g.:
#   reg -- tests/highlighted/bat-short.0.22.1.txt`
# to exclude e.g. THEME-italics, do:
#   reg -- ":^*-italics*"
function reg {
    if [[ "$*" != *"-- "* ]]; then
        GIT_PAGER="LESS=R less" git diff "$@" -- tests/{highlighted,theme}
    else
        # the function args include a path filter
        GIT_PAGER="LESS=R less" git diff "$@"
    fi
}

function regs {
    reg --staged "$@"
}

function regmain {
    reg main "$@"
}

# regression tests show
function regshow {
    if [[ "$*" != *"-- "* ]]; then
        GIT_PAGER="LESS=R less" git show "$@" -- tests/{highlighted,theme}
    else
        GIT_PAGER="LESS=R less" git show "$@"
    fi
}

alias git0='GIT_CONFIG=/dev/null git'

# run a syntax test in debug mode
function debug {
    tests/syntax.py "$@" -d | less -R
}

function demo {
    "$@" --help | bat --no-config -pl cmd-help --pager='less -R'
}

function demo_it {
    "$@" --help | bat --no-config -pl cmd-help --pager='less -R' --italic-text=always
}

alias mksyn='scripts/make_syntax_test.sh'

alias try='scripts/try_input.sh'
